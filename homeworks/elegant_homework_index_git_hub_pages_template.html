<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Homework Portal — Index</title>
  <meta name="description" content="A minimalist, elegant index page for students to access homework forms." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Serif+JP:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0f1115;          /* deep night */
      --panel: #151821;       /* ink slate */
      --muted: #7c8596;       /* quiet steel */
      --text: #eef1f6;        /* moonlight */
      --accent: #a5b4fc;      /* periwinkle */
      --accent-2: #8bd3dd;    /* cool cyan */
      --ring: rgba(165,180,252,.35);
      --chip: #222639;
      --card: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: #f7f7fb;
        --panel: #ffffff;
        --muted: #6a7280;
        --text: #0e1116;
        --accent: #4f46e5;
        --accent-2: #0ea5a8;
        --ring: rgba(79,70,229,.25);
        --chip: #eef2ff;
        --card: linear-gradient(180deg, rgba(0,0,0,0.03), rgba(0,0,0,0.01));
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans JP", Arial, sans-serif;
      color:var(--text); background:radial-gradient(1000px 600px at 90% -10%, rgba(165, 180, 252, 0.06), transparent),
                           radial-gradient(800px 500px at 10% 0%, rgba(139, 211, 221, 0.07), transparent),
                           var(--bg);
    }
    .wrap{max-width:1100px; margin:0 auto; padding:24px 18px 56px}
    header{
      position:relative; border-radius:20px; padding:28px 22px; background:var(--panel);
      box-shadow:0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.04);
      overflow:hidden;
    }
    .orbs{position:absolute; inset:-2px; pointer-events:none;}
    .orb{position:absolute; width:220px; height:220px; border-radius:50%; filter:blur(40px); opacity:.28}
    .orb.a{right:-60px; top:-60px; background:radial-gradient(circle at 30% 30%, var(--accent), transparent 60%)}
    .orb.b{left:-80px; top:-80px; background:radial-gradient(circle at 70% 70%, var(--accent-2), transparent 60%)}
    h1{margin:0; font-size:clamp(28px, 3.5vw, 40px); letter-spacing:0.2px; font-weight:700}
    .sub{margin:8px 0 0; color:var(--muted); font-size:15px}
    .controls{display:flex; flex-wrap:wrap; gap:10px; margin-top:18px}
    .chip{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; background:var(--chip); color:var(--text); border:1px solid rgba(255,255,255,.06)}
    .chip button{background:transparent; border:0; color:inherit; cursor:pointer; font:inherit}
    .chip[data-active="true"]{outline:2px solid var(--ring)}

    .bar{display:flex; gap:10px; margin-top:16px; flex-wrap:wrap}
    .search{flex:1 1 360px; position:relative}
    .search input{
      width:100%; padding:14px 44px 14px 44px; border-radius:14px; background:var(--panel);
      border:1px solid rgba(255,255,255,.08); color:var(--text); font-size:15px; outline: none;
      box-shadow:0 0 0 0 rgba(0,0,0,0);
    }
    .search input:focus{box-shadow:0 0 0 6px var(--ring)}
    .search .icon{position:absolute; left:14px; top:50%; transform:translateY(-50%); opacity:.6}
    .search .kbd{position:absolute; right:10px; top:50%; transform:translateY(-50%); opacity:.5; font-size:12px; padding:2px 6px; border-radius:6px; border:1px solid rgba(255,255,255,.15)}

    .grid{display:grid; grid-template-columns:repeat(12, 1fr); gap:16px; margin-top:22px}
    .card{grid-column: span 12; background:var(--card); border:1px solid rgba(255,255,255,.08); border-radius:18px; padding:16px 16px 14px; backdrop-filter: blur(8px);
      transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    }
    @media(min-width:700px){ .card{grid-column: span 6} }
    @media(min-width:1000px){ .card{grid-column: span 4} }
    .card:hover{ transform: translateY(-2px); box-shadow:0 12px 30px rgba(0,0,0,.20); border-color: rgba(165,180,252,.35)}
    .card h3{margin:2px 0 8px; font-size:18px}
    .meta{display:flex; flex-wrap:wrap; gap:8px; color:var(--muted); font-size:12px}
    .meta .pill{padding:4px 8px; border-radius:999px; border:1px solid rgba(255,255,255,.10)}
    .go{margin-top:12px; display:flex; align-items:center; justify-content:space-between; gap:12px}
    .go a{display:inline-flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; text-decoration:none; color:var(--text); border:1px solid rgba(255,255,255,.10)}
    .go a span{opacity:.9}
    .go a:hover{box-shadow:0 0 0 5px var(--ring); border-color: transparent}
    .note{color:var(--muted); font-size:13px; margin:10px 0 0}

    .empty{opacity:.7; text-align:center; padding:40px 10px; font-size:15px}
    footer{margin-top:28px; color:var(--muted); font-size:12px; text-align:center}

    /* Tiny icon set */
    .ico{width:18px; height:18px; display:inline-block}
    .ico svg{width:100%; height:100%}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="orbs"><div class="orb a"></div><div class="orb b"></div></div>
      <h1>Homework Portal</h1>
      <p class="sub">Calm, precise, and beautifully simple — a gateway to your forms. Choose a course, search, and begin.</p>

      <div class="controls" id="courseChips">
        <!-- chips inserted by JS -->
      </div>

      <div class="bar">
        <div class="search">
          <span class="icon ico" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><circle cx="11" cy="11" r="7"/><path d="m21 21-4.3-4.3"/></svg>
          </span>
          <input id="q" type="search" placeholder="Search title, chapter, tags… (Press / to focus)" autocomplete="off" />
          <span class="kbd">/</span>
        </div>
        <div class="chip" title="Toggle layout" id="toggleLayout">
          <span class="ico" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg></span>
          <button>Compact</button>
        </div>
      </div>
    </header>

    <main class="grid" id="grid"></main>
    <div id="empty" class="empty" hidden>No matches. Try clearing filters or checking spelling.</div>

    <footer>
      <div>Made for your classes — Algebra, Geometry, and more. <span style="opacity:.7">美しく、静かに、正確に。</span></div>
    </footer>
  </div>

  <!-- Optional manifest(s). If present, they set window.homeworkIndex = [...] -->
  <!-- You can generate /assets/filelist.js automatically; the page looks for these in order. -->
  <script src="/math-homework/assets/filelist.js" defer></script>
  <script src="/filelist.js" defer></script>

  <script>
  /*
    ================================
    Elegant Homework Index — Script
    ================================
    Personality: minimalist, quiet contrast, mathematical order.

    How to use:
    1) Provide a filelist.js that defines window.homeworkIndex = [
         {
           classId: "Algebra1",              // required (filters use this)
           title: "Homework 7-10 — Systems of Inequalities",
           chapter: "7",                      // optional, string or number
           section: "10",                     // optional
           id: "HW 7-10",                     // optional short id
           date: "2025-08-28",                // ISO or yyyy-mm-dd preferred
           url: "/math-homework/homeworks/Algebra1/hw_7_10.html",
           tags: ["graphing","inequalities","systems"],
           pinned: false                      // optional, show first if true
         }, ...
       ]
    2) If you don’t supply filelist.js, a small demo list renders so you can verify layout.
  */

  const courses = ["All", "Algebra1", "Algebra2", "Geometry", "Computer", "Other"]; // adjust as needed
  const courseLabels = {
    All: "All",
    Algebra1: "Algebra 1",
    Algebra2: "Algebra 2",
    Geometry: "Geometry",
    Computer: "Computer / IT",
    Other: "Other"
  };

  const state = {
    course: "All",
    query: "",
    compact: false
  };

  const elGrid = document.getElementById('grid');
  const elEmpty = document.getElementById('empty');
  const elQ = document.getElementById('q');
  const elChips = document.getElementById('courseChips');

  // Build course chips
  courses.forEach(c => {
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.dataset.active = c === state.course ? 'true' : 'false';
    chip.innerHTML = `<span class="ico" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><circle cx="12" cy="12" r="9"/></svg></span><button>${courseLabels[c]||c}</button>`;
    chip.addEventListener('click', () => {
      state.course = c; [...elChips.children].forEach(n=>n.dataset.active='false'); chip.dataset.active='true'; render();
    });
    elChips.appendChild(chip);
  });

  // Keyboard focus ("/")
  window.addEventListener('keydown', (e)=>{ if(e.key === '/' && document.activeElement !== elQ){ e.preventDefault(); elQ.focus(); } });
  elQ.addEventListener('input', ()=>{ state.query = elQ.value.trim().toLowerCase(); render(); });

  // Compact toggle
  document.getElementById('toggleLayout').addEventListener('click', () => {
    state.compact = !state.compact; document.body.classList.toggle('compact', state.compact); render();
  });

  // Data source (fallback demo if no manifest loaded yet)
  const demo = [
    {classId:"Algebra1", title:"Homework 7-10 — Systems of Inequalities", chapter:"7", section:"10", id:"HW 7-10", date:"2025-08-28", url:"/math-homework/homeworks/Algebra1/hw_7_10.html", tags:["graph","inequalities","systems"], pinned:true},
    {classId:"Algebra1", title:"Homework 6-10 — Graphing Linear Inequalities", chapter:"6", section:"10", id:"HW 6-10", date:"2025-08-27", url:"/math-homework/homeworks/Algebra1/hw_6_10.html", tags:["graph","inequalities"]},
    {classId:"Algebra2", title:"Chapter 6 Review", chapter:"6", id:"Ch 6 Review", date:"2025-08-29", url:"/math-homework/homeworks/Algebra2/ch6-review.html", tags:["review","graphs"]},
    {classId:"Geometry", title:"Homework 3-4 — Triangle Congruence", chapter:"3", section:"4", id:"HW 3-4", date:"2025-06-02", url:"/math-homework/homeworks/Geometry/hw_3_4.html", tags:["triangles","congruence"]}
  ];

  function getData(){
    // Prefer manifest if it has loaded; otherwise demo
    return Array.isArray(window.homeworkIndex) && window.homeworkIndex.length ? window.homeworkIndex : demo;
  }

  function normalize(x){ return (x||'').toString().trim().toLowerCase(); }
  function dateVal(d){ const t = Date.parse(d); return isNaN(t) ? 0 : t; }

  function render(){
    const data = getData().slice();
    // sort: pinned first, then date desc, then title
    data.sort((a,b)=> (b.pinned|0)-(a.pinned|0) || dateVal(b.date)-dateVal(a.date) || (a.title||'').localeCompare(b.title||''));

    const q = state.query;
    const filtered = data.filter(item => {
      if(state.course !== 'All' && (item.classId||'Other') !== state.course) return false;
      if(!q) return true;
      const blob = [item.title, item.chapter, item.section, item.id, (item.tags||[]).join(' '), item.classId].map(normalize).join(' ');
      return blob.includes(q);
    });

    elGrid.innerHTML = '';
    elEmpty.hidden = filtered.length !== 0;

    filtered.forEach(item => elGrid.appendChild(card(item)));
  }

  function card(item){
    const c = document.createElement('article');
    c.className = 'card';

    const course = courseLabels[item.classId] || item.classId || 'Other';
    const chap = item.chapter ? `Ch ${item.chapter}` : '';
    const sec = item.section ? `· ${item.section}` : '';
    const id = item.id ? ` — ${item.id}` : '';

    const date = item.date ? new Date(item.date) : null;
    const dstr = date ? date.toLocaleDateString(undefined, {year:'numeric', month:'short', day:'numeric'}) : '';

    const tags = (item.tags||[]).map(t => `<span class="pill">${escapeHtml(t)}</span>`).join('');

    c.innerHTML = `
      <h3>${escapeHtml(item.title || 'Untitled')}${id}</h3>
      <div class="meta">
        <span class="pill">${escapeHtml(course)}</span>
        ${chap ? `<span class="pill">${chap}${sec}</span>` : ''}
        ${dstr ? `<span class="pill" title="Assigned/Updated">${dstr}</span>` : ''}
        ${item.pinned ? `<span class="pill" title="Pinned">★ Pinned</span>` : ''}
        ${tags}
      </div>
      <div class="go">
        <a href="${item.url}" target="_blank" rel="noopener">
          <span class="ico" aria-hidden="true"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M7 17 17 7"/><path d="M7 7h10v10"/></svg></span>
          <span>Open Form</span>
        </a>
        <div class="note">${escapeHtml(item.note || '')}</div>
      </div>
    `;
    return c;
  }

  function escapeHtml(s){return String(s||'').replace(/[&<>"']/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[m]));}

  // Initial render (allow time for optional filelist.js to load)
  document.addEventListener('DOMContentLoaded', () => {
    // Re-render once more after external scripts settle
    render(); setTimeout(render, 80); setTimeout(render, 200);
  });
  </script>
</body>
</html>
